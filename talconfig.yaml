---
clusterName: goldentooth
talosVersion: v1.11.1
kubernetesVersion: v1.34.0
endpoint: https://cp.k8s.goldentooth.net:6443
domain: cluster.local
allowSchedulingOnControlPlanes: true
additionalApiServerCertSans:
  - 10.4.0.9
  - 10.4.0.10
  - 10.4.0.11
  - 10.4.0.12
  - cp.k8s.goldentooth.net
clusterPodNets:
  - 10.244.0.0/16
clusterSvcNets:
  - 10.96.0.0/12
patches:
  - |-
    cluster:
      network:
        cni:
          name: none
      proxy:
        disabled: true
nodes:
  - hostname: allyrion
    ipAddress: 10.4.0.10
    installDisk: /dev/mmcblk0
    controlPlane: true
    nodeLabels:
      slot: 'A'
    nodeAnnotations:
      slot: 'A'
  - hostname: bettley
    ipAddress: 10.4.0.11
    installDisk: /dev/mmcblk0
    controlPlane: true
    nodeLabels:
      slot: 'B'
    nodeAnnotations:
      slot: 'B'
  - hostname: cargyll
    ipAddress: 10.4.0.12
    installDisk: /dev/mmcblk0
    controlPlane: true
    nodeLabels:
      slot: 'C'
    nodeAnnotations:
      slot: 'C'
  - hostname: dalt
    ipAddress: 10.4.0.13
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'D'
    nodeAnnotations:
      slot: 'D'
  - hostname: erenford
    ipAddress: 10.4.0.14
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'E'
      storage.seaweedfs/volume: 'true'
    nodeAnnotations:
      slot: 'E'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: fenn
    ipAddress: 10.4.0.15
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'F'
      storage.seaweedfs/volume: 'true'
    nodeAnnotations:
      slot: 'F'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: gardener
    ipAddress: 10.4.0.16
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'G'
      storage.seaweedfs/volume: 'true'
    nodeAnnotations:
      slot: 'G'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: harlton
    ipAddress: 10.4.0.17
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'H'
    nodeAnnotations:
      slot: 'H'
  - hostname: inchfield
    ipAddress: 10.4.0.18
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'I'
      storage.seaweedfs/volume: 'true'
    nodeAnnotations:
      slot: 'I'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: jast
    ipAddress: 10.4.0.19
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'J'
    nodeAnnotations:
      slot: 'J'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: karstark
    ipAddress: 10.4.0.20
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'K'
      storage.seaweedfs/volume: 'true'
    nodeAnnotations:
      slot: 'K'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: lipps
    ipAddress: 10.4.0.21
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'L'
      storage.seaweedfs/volume: 'true'
    nodeAnnotations:
      slot: 'L'
    userVolumes:
      - name: usb
        provisioning:
          diskSelector:
            match: disk.transport == "usb"
          minSize: 1GiB
        filesystem:
          type: xfs
  - hostname: manderly
    ipAddress: 10.4.0.22
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'M'
    nodeAnnotations:
      slot: 'M'
  - hostname: norcross
    ipAddress: 10.4.0.23
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'N'
    nodeAnnotations:
      slot: 'N'
  - hostname: oakheart
    ipAddress: 10.4.0.24
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'O'
    nodeAnnotations:
      slot: 'O'
  - hostname: payne
    ipAddress: 10.4.0.25
    installDisk: /dev/mmcblk0
    controlPlane: false
    nodeLabels:
      slot: 'P'
    nodeAnnotations:
      slot: 'P'
  - hostname: velaryon
    ipAddress: 10.4.0.30
    installDisk: /dev/nvme0n1
    controlPlane: false
    nodeLabels:
      role: 'gpu'
      slot: 'X'
      nvidia.com/gpu.present: 'true'
    nodeAnnotations:
      role: 'gpu'
      slot: 'X'
    nodeTaints:
      gpu: "true:NoSchedule"
      platform: "x86:NoSchedule"
    overridePatches: true
    schematic:
      customization:
        systemExtensions:
          officialExtensions:
            - siderolabs/nonfree-kmod-nvidia-lts
            - siderolabs/nvidia-container-toolkit-lts
            - siderolabs/uinput
    patches:
      - |-
        machine:
          kernel:
            modules:
              - name: nvidia
              - name: nvidia_uvm
              - name: nvidia_drm
              - name: nvidia_modeset
              - name: uinput
          sysctls:
            net.core.bpf_jit_harden: 1
            user.max_user_namespaces: "100"
            vm.max_map_count: "524288"
          udev:
            rules:
              # Make input devices readable by all users (for Steam/gaming)
              - 'KERNEL=="event*", SUBSYSTEM=="input", MODE="0666"'
controlPlane:
  patches:
    - |-
      machine:
        network:
          interfaces:
            - interface: end0
              dhcp: true
              vip:
                ip: 10.4.0.9
worker:
  patches: []
  schematic:
    customization:
      systemExtensions:
        officialExtensions:
          - siderolabs/iscsi-tools
          - siderolabs/util-linux-tools
